id: count_2020_auto
namespace: datatalks.de_zoomcamp

description: |
  Calcule automatiquement le total pour 2020.
  Pour Question 3: taxi=yellow
  Pour Question 4: taxi=green

inputs:
  - id: taxi
    type: SELECT
    displayName: Select taxi type
    values: [yellow, green]
    defaults: yellow

tasks:
  - id: process_all_months
    type: io.kestra.plugin.core.flow.ForEach
    values: ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"]
    tasks:
      - id: process_month
        type: io.kestra.plugin.core.flow.Subflow
        namespace: datatalks.de_zoomcamp
        flowId: taxi_data
        inputs:
          taxi: "{{inputs.taxi}}"
          year: "2020"
          month: "{{taskrun.value}}"
        wait: true

  - id: summary
    type: io.kestra.plugin.core.log.Log
    message: |
      ✓ Tous les mois de 2020 ({{inputs.taxi}}) ont été traités!
      